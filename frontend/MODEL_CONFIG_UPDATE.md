# 模型配置界面更新说明

## 更新概述
根据提供的模型配置API文档和TOML配置文件，重新设计了模型配置管理界面。

## 主要功能

### 1. API服务提供商管理
- **显示所有配置的API服务商**
- **添加新的服务商**：支持DeepSeek、SiliconFlow等各种提供商
- **编辑服务商配置**：URL、API密钥、超时设置等
- **删除服务商**：带安全确认
- **连接测试**：测试API连接状态
- **配置项**：
  - 名称（如"DeepSeek"、"SiliconFlow"）
  - 基础URL（如"https://api.deepseek.cn/v1"）
  - API密钥（支持显示/隐藏）
  - 客户端类型（OpenAI/Gemini）
  - 最大重试次数
  - 超时时间（秒）
  - 重试间隔（秒）

### 2. 模型配置管理
- **显示所有配置的模型**
- **添加新模型**：绑定到已有的API服务商
- **编辑模型参数**
- **删除模型**：带依赖检查
- **配置项**：
  - 模型标识符（如"deepseek-chat"）
  - 模型名称（如"deepseek-v3"）
  - 关联的API服务商
  - 价格设置（输入/输出token价格）
  - 强制流式输出模式
  - 启用思考模式

### 3. 任务模型分配
为不同的任务类型分配专用模型：
- **通用工具（utils）**：表情包、取名、关系等组件
- **小型工具（utils_small）**：高频使用的快速小模型
- **首要回复（replyer）**：主要对话回复
- **决策规划（planner）**：决定麦麦行为
- **情绪管理（emotion）**：情绪变化处理
- **图像识别（vlm）**：视觉理解
- **语音识别（voice）**：语音转文字
- **工具调用（tool_use）**：函数调用支持
- **嵌入模型（embedding）**：向量计算
- **LPMM相关**：知识库功能（实体提取、RDF构建、问答）

每个任务可配置：
- 使用的模型
- 温度参数（0-2，控制创造性）
- 最大Token数

## 界面特性

### 1. 响应式设计
- 适配各种屏幕尺寸
- 移动端友好的布局
- Flex布局，每个参数单独一行

### 2. DaisyUI组件
- 使用DaisyUI的卡片、按钮、表单组件
- 统一的主题色彩
- 美观的渐变背景

### 3. 交互体验
- 实时表单验证
- 加载状态指示
- 成功/错误消息提示
- 确认删除对话框
- API密钥可见性切换

### 4. 数据安全
- API密钥默认隐藏
- 删除操作需要确认
- 依赖检查（删除正在使用的服务商/模型会提示）

## 技术实现

### 1. 新增文件
- `src/types/modelConfig.ts` - 模型配置相关类型定义
- `src/utils/modelConfigApi.ts` - 模型配置API调用封装

### 2. API集成
支持所有文档中的API端点：
- `GET /api/config/model/get` - 获取当前配置
- `POST /api/config/model/update` - 更新配置
- `POST /api/config/model/addProvider` - 添加服务商
- `DELETE /api/config/model/deleteProvider` - 删除服务商
- `POST /api/config/model/addModel` - 添加模型
- `DELETE /api/config/model/deleteModel` - 删除模型

### 3. 状态管理
- 响应式数据绑定
- 变更检测（hasChanges）
- 表单验证
- 错误处理

## 使用说明

1. **访问界面**：通过导航菜单进入"设置 -> 模型设置"
2. **配置服务商**：先添加API服务提供商
3. **添加模型**：创建模型配置并绑定到服务商
4. **任务分配**：为不同任务类型分配合适的模型
5. **测试连接**：确保API服务商连接正常
6. **保存配置**：点击保存按钮应用所有更改

## 注意事项

- 删除服务商前请确保没有模型正在使用
- 删除模型前请确保没有任务配置引用
- API密钥敏感信息请妥善保管
- 定期测试API连接确保服务可用

## 未来扩展

- 批量操作功能
- 配置导入/导出
- 模型性能监控
- 使用统计报表
